<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">

  <title>Getting Started with ml5.js</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- p5 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/addons/p5.dom.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/addons/p5.sound.min.js"></script>
  <!-- ml5 -->
  <script src="https://unpkg.com/ml5@0.4.3/dist/ml5.min.js"></script>

</head>

<body>
<script>
  // Initialize the Image Classifier method with MobileNet. A callback needs to be passed.
  let video;
  let poseNet;
  let noseX = 0;
  let noseY = 0;
  let eyelX = 0;
  let eyelY = 0;

  function setup() {
    createCanvas(640, 480);
    video = createCapture(VIDEO);
    video.hide();
    poseNet = ml5.poseNet(video, modelReady);
    poseNet.on('pose', gotPoses);
  }

  function gotPoses(poses) {
    // console.log(poses);
    if (poses.length > 0) {
      let nX = poses[0].pose.keypoints[0].position.x;
      let nY = poses[0].pose.keypoints[0].position.y;
      let eX = poses[0].pose.keypoints[1].position.x;
      let eY = poses[0].pose.keypoints[1].position.y;
      noseX = lerp(noseX, nX, 0.5);
      noseY = lerp(noseY, nY, 0.5);
      eyelX = lerp(eyelX, eX, 0.5);
      eyelY = lerp(eyelY, eY, 0.5);
    }
  }

  function modelReady() {
    console.log('model ready');
  }

  function draw() {
    image(video, 0, 0);

    let d = dist(noseX, noseY, eyelX, eyelY);

    fill(255, 0, 0);
    ellipse(noseX, noseY, d);
    //fill(0,0,255);
    //ellipse(eyelX, eyelY, 50);


  }

</script>
</body>

</html>
